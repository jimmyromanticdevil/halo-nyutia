var removeElements=function(a){return a.forEach(function(a){return a.remove()})};sessionStorage.removeItem("language");
function baseDict(){return{suggestions:{id:"Saran",en:"Suggestions"},destask:{id:"Mau kemana nih?",en:"Where is your destination?"},askwhat:{en:"Ok, what do you want to know about",id:"Baiklah, apa yang ingin Anda ketahui tentang "},quicksuggest:{en:["Change my destination","About "+getDest(),"How do I get to "+getDest(),"Where to stay at "+getDest(),"Best time to go "+getDest(),"Things to do in "+getDest(),"Entrance fee for "+getDest(),getDest()+" Opening hours",getDest()+" Facilities","Things to note for "+
getDest()+" trip","News from "+getDest(),"Transportations","Event this month"],id:["Ubah destinasi saya","Tentang "+getDest(),"Bagaimana saya bisa pergi ke "+getDest(),"Tempat tinggal di "+getDest(),"Waktu terbaik untuk pergi ke "+getDest(),"Yang bisa di lakukan di "+getDest(),"Biaya masuk untuk "+getDest(),"Jam buka "+getDest(),"Fasilitas di "+getDest(),"Hal-hal yang perlu diperhatikan untuk trip ke "+getDest(),"Info baru tentang "+getDest(),"Transportasi","Event bulan ini"]}}}var dict;
function initialize(){dict={};base=baseDict();for(var a in base)base.hasOwnProperty(a)&&(dict[a]=base[a])}initialize();function getDest(){return sessionStorage.getItem("destination")}loadCSS=function(a){a="<link rel='stylesheet' type='text/css' href='"+a+"'>";document.querySelector("head").innerHTML+=a};langLoad=function(a){addLang({quickReplies:["Indonesia","English"]})};
loadSuggest=function(a){sessionStorage.getItem("destination")?a={quickReplies:getDict("quicksuggest")}:(setBotResponse(getDict("destask")),a={quickReplies:"Ijen;Baluran;Sukamade;Alas Purwo;Meuru Betiri;Green Bay;Red Island".split(";")});addSuggestion(a)};function getDict(a){var b=sessionStorage.getItem("language");return dict[a][b]}loadCSS("https://chatbot.next-web.id/static/chatbot/dinparbwi/v2.4/style.min.css");var baseUrl="/sendmessage";setBotResponse("Selamat datang di chatbot @askbwi. Saya di sini untuk membantu Anda dengan semua informasi pariwisata Banyuwangi. Tak perlu sungkan bertanya pada saya. :)");
sessionStorage.getItem("language")?loadSuggest():(setBotResponse("Pilih Bahasa Anda (Please select your language)"),langLoad());var tagBody="(?:[^\"'>]|\"[^\"]*\"|'[^']*')*",tagOrComment=new RegExp("<(?:!--(?:(?:-*[^->])*--+|-?)|script\\b"+tagBody+">[\\s\\S]*?\x3c/script\\s*|style\\b"+tagBody+">[\\s\\S]*?</style\\s*|/?[a-z]"+tagBody+")>","gi");function removeTags(a){do{var b=a;a=a.replace(tagOrComment,"")}while(a!==b);return a.replace(/</g,"&lt;")}var mybot='<div class="chatCont" id="chatCont"><div class="bot_profile"><img src="https://chatbot.next-web.id/static/chatbot/dinparbwi/v2.4/mbanyutia.png" class="bot_p_img"><div class="box-close"><div class="close"><img src="https://chatbot.next-web.id/static/chatbot/dinparbwi/v2.4/remove-symbol.svg"/></div></div></div>\x3c!--bot_profile end--\x3e<div id="result_div" class="resultDiv"></div><div class="spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div>\x3c!--chatCont end--\x3e<div class="profile_div"><div class="row"><div class="col-hgt"><img src="https://chatbot.next-web.id/static/chatbot/dinparbwi/v2.4/mbanyutia.png" class="img-profile"></div></div>\x3c!--row end--\x3e</div>\x3c!--profile_div end--\x3e';
String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};var el=document.querySelector("mybot");el.innerHTML=mybot;var chatcont=document.querySelector(".chatCont"),bot_profile=document.querySelector(".bot_profile"),profile=document.querySelector(".profile_div"),show=function(a){a.style.display="block"},hide=function(a){a.style.display="none"};profile.onclick=function(){hide(profile);show(chatcont);show(bot_profile)};var close=document.querySelector(".close");
close.onclick=function(){show(profile);hide(chatcont);hide(bot_profile)};var session=function(){if(sessionStorage.getItem("session"))var a=sessionStorage.getItem("session");else{a=Math.floor(1E3*Math.random()+1);var b=Date.now(),d=new Date,c=Array(7);c[0]="Sunday";c[1]="Monday";c[2]="Tuesday";c[3]="Wednesday";c[4]="Thursday";c[5]="Friday";c[6]="Saturday";d=c[d.getDay()];sessionStorage.setItem("session",a+d+b);a=sessionStorage.getItem("session")}return a},mysession=session();
function send(a){fetch(baseUrl,{method:"POST",body:JSON.stringify({message:a,lang:sessionStorage.getItem("language"),sessionId:mysession}),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(function(a){a.json().then(function(a){main(a)})})["catch"](function(a){return console.error("Error:",a)})}
function main(a){if((a=a.fulfillmentMessages)&&0<=a.length)if(a[0].platform)setBotResponse(a[0].quickReplies.title),addSuggestion(a[0].quickReplies);else{for(var b=0;b<a.length;b++)a[b].text.text&&setBotResponse(a[b].text.text[0]);loadSuggest()}}function createTextLinks(a){return(a||"").replace(/([^\S]|^)(((https?:\/\/)|(www\.))(\S+))/gi,function(a,d,c){a=c;a.match("^https?://")||(a="http://"+a);return d+'<a href="'+a+'">Link</a>'})}
function setBotResponse(a){setTimeout(function(){if(""!=a.trim()){var b='<p class="botResult">'+createTextLinks(a)+'</p><div class="clearfix"></div>';document.getElementById("result_div").innerHTML+=b}hideSpinner()},500)}function removeSuggest(){removeElements(document.querySelectorAll(".suggestion"))}function appendtoID(a,b){var d=document.getElementById(a),c=document.createElement("div");c.innerHTML=b;d.appendChild(c)}function appendtoClass(a,b){document.querySelector(a).innerHTML+=b}
function setUserResponse(a){appendtoID("result_div",'<p class="userEnteredText">'+a+'</p><div class="clearfix"></div>');showSpinner();removeSuggest()}function showSpinner(){var a=document.querySelector(".spinner");show(a)}function hideSpinner(){var a=document.querySelector(".spinner");hide(a)}
function addLang(a){setTimeout(function(){var b=a.quickReplies,d=a.quickReplies.length;appendtoID("result_div",'<p class="suggestion"></p>');for(i=0;i<d;i++)appendtoClass(".suggestion",'<span class="sugg-options" onclick="clickerLg(this)">'+b[i]+"</span>")},1E3)}
function addSuggestion(a){setTimeout(function(){var b=a.quickReplies,d=a.quickReplies.length;appendtoID("result_div",'<p class="suggestion"></p>');appendtoClass(".suggestion",'<div class="sugg-title">'+getDict("suggestions")+": </div>");for(i=0;i<d;i++)appendtoClass(".suggestion",'<span class="sugg-options" onclick="clickerFn(this)">'+b[i]+"</span>");hideSpinner()},1E3)}
clickerLg=function(a){a=a.innerText;"Indonesia"==a?sessionStorage.setItem("language","id"):sessionStorage.setItem("language","en");setUserResponse(a);loadSuggest()};
clickerFn=function(a){a=a.innerText;"Ijen;Baluran;Sukamade;Alas Purwo;Meuru Betiri;Green Bay;Red Island".split(";").includes(a)?(sessionStorage.setItem("destination",a),initialize(),setUserResponse(a),setBotResponse(getDict("askwhat")+a+"?"),loadSuggest()):"Change my destination"==a||"Ubah destinasi saya"==a?(setUserResponse(a),sessionStorage.removeItem("destination"),loadSuggest()):(setUserResponse(a),send(a));removeSuggest()};
